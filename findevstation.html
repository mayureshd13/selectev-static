<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Find Nearest EV Charging Station</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
/* Base styles */
body {
    font-family: 'Poppins', sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f4f4f9;
}

/* Fade-in animation */
@keyframes fadeIn {
  0% { opacity: 0; }
  100% { opacity: 1; }
}

/* Slide-in animation for hero section */
@keyframes slideIn {
  0% { transform: translateY(-50px); opacity: 0; }
  100% { transform: translateY(0); opacity: 1; }
}

header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px;
  background-color: #223243;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  animation: fadeIn 1s ease-in;
}

header h1 {
  color: #00dfc4;
  animation: fadeIn 2s ease-in;
}

nav ul {
  display: flex;
  list-style: none;
}

nav li {
  margin-right: 20px;
}

nav a {
  color: #c9b8b8;
  text-decoration: none;
  font-weight: bold;
  font-size: 18px;
  transition: color 0.3s ease-in-out;
}

nav a:hover {
  color: #e67e22;
}

main {
    padding: 20px;
    max-width: 1200px;
    margin: auto;
}

#map {
    height: 500px;
    width: 100%;
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.form-container {
    background-color: #434d58;
    padding: 20px;
    border-radius: 10px;
    margin-bottom: 20px;
    color: #fff;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.form-container h2 {
    margin-top: 0;
    font-size: 1.5rem;
    color: #00dfc4;
}

.form-container label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
}

.form-container input,
.form-container button {
    width: 100%;
    padding: 10px;
    margin-bottom: 10px;
    border-radius: 5px;
    border: none;
    font-size: 1rem;
}

.form-container button {
    background-color: #e67e22;
    color: white;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

.form-container button:hover {
    background-color: #276469;
}

.list-container {
    background-color: #fff;
    padding: 20px;
    border-radius: 10px;
    margin-bottom: 20px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    max-height: 200px;
    overflow-y: auto;
}

.list-container ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

.list-container li {
    padding: 10px;
    border-bottom: 1px solid #ddd;
    cursor: pointer;
}

.list-container li:hover {
    background-color: #f4f4f9;
}

footer {
    text-align: center;
    padding: 10px;
    background-color: #223243;
    color: #fff;
    font-size: 0.9rem;
}

footer a {
    color: #00dfc4;
    text-decoration: none;
}

footer a:hover {
    text-decoration: underline;
}

/* Responsive styles */
@media (max-width: 768px) {
    header {
        flex-direction: column;
    }

    nav ul {
        flex-direction: column;
        align-items: flex-start;
    }

    nav li {
        margin-bottom: 10px;
        margin-right: 0;
    }
}

@media (max-width: 600px) {
    .form-container,
    .list-container {
        padding: 10px;
    }

    .form-container input,
    .form-container button {
        font-size: 0.9rem;
        padding: 8px;
    }
}
</style>
</head>
<body>
    <header>
        <h1>Find Charging Station</h1>
        <nav>
          <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="products.html">Products</a></li>
            <li><a href="aboutus.html">About Us</a></li>
            <li><a href="findevstation.html">Find Ev Station</a></li>
    
          </ul>
        </nav>
      </header>
    
    <main>
        <div class="form-container">
            <h2>Enter Your City</h2>
            <form id="search-form">
                <label for="city">City:</label>
                <input type="text" id="city" placeholder="Enter your city">
                <button type="submit">Find Stations</button>
            </form>
        </div>
        <div class="list-container">
            <ul id="station-list"></ul>
        </div>
        <div id="map"></div>
    </main>
    <footer>
        <p>Â© 2025 SELECT-EV. All rights reserved. | <a href="#">Privacy Policy</a> | <a href="#">Terms & Conditions</a></p>
    </footer>
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
        // Initialize the map
        const map = L.map('map').setView([20.5937, 78.9629], 5); // Centered on India

        // Add OpenStreetMap tiles
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Custom Marker Icon
        const stationIcon = L.icon({
            iconUrl: 'icon.png', // Replace with your custom icon URL
            iconSize: [32, 32],
            iconAnchor: [16, 32],
            popupAnchor: [0, -32]
        });

        // Highlight Marker Icon
        const highlightIcon = L.icon({
            iconUrl: 'icon1.png', // Replace with your highlight icon URL
            iconSize: [32, 32],
            iconAnchor: [16, 32],
            popupAnchor: [0, -32]
        });

        let stationsData = [];
        let currentMarker = null;

        // Fetch EV charging stations and add markers
        async function fetchStations(city) {
            // Replace with your actual JSON file URL
            const jsonUrl = 'ev_stations.json';

            try {
                const response = await fetch(jsonUrl); // Fetch the local JSON file
                const data = await response.json();
                console.log(data);  // Debugging: log the data received from the JSON file
                stationsData = data;

                if (data && data.length > 0) {
                    // Filter stations by city
                    const filteredStations = data.filter(station => station.city.toLowerCase() === city.toLowerCase());

                    if (filteredStations.length > 0) {
                        // Clear any existing markers
                        map.eachLayer((layer) => {
                            if (layer instanceof L.Marker) {
                                map.removeLayer(layer);
                            }
                        });

                        // Clear the list
                        const stationList = document.getElementById('station-list');
                        stationList.innerHTML = '';

                        // Iterate over the filtered data and add markers for each charging station
                        filteredStations.forEach((station, index) => {
                            const lat = station.lattitude;
                            const lon = station.longitude;

                            // Center the map on the first charging station
                            map.setView([lat, lon], 12);

                            // Add custom marker for the charging station
                            const marker = L.marker([lat, lon], { icon: stationIcon })
                                .addTo(map)
                                .bindPopup(`Charging Station in ${city}`);

                            // Add list item
                            const listItem = document.createElement('li');
                            listItem.textContent = station.address;
                            listItem.addEventListener('click', () => {
                                if (currentMarker) {
                                    currentMarker.setIcon(stationIcon); // Reset previously highlighted marker
                                }
                                map.setView([lat, lon], 12);
                                marker.setIcon(highlightIcon); // Highlight the selected marker
                                currentMarker = marker; // Set the current marker
                            });
                            stationList.appendChild(listItem);
                        });
                    } else {
                        alert('No charging stations found in the city.');
                    }
                } else {
                    alert('No charging stations found in the city.');
                }
            } catch (error) {
                console.error('Error fetching data from JSON file:', error);
                alert('An error occurred while fetching data.');
            }
        }

        // Handle form submission
        document.getElementById('search-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const city = document.getElementById('city').value.trim();
            if (city) {
                fetchStations(city);
            } else {
                alert('Please enter a city name.');
            }
        });
    </script>
</body>
</html>
